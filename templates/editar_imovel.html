{% extends "template.html" %}
{% block conteudo %}
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
<script src="{{url_for('static', filename='jquery-3.6.0.min.js') }}"></script>
<script src="{{url_for('static', filename='jquery.mask.js') }}"></script>
<script>
  $(document).ready(function () {
    $('#valor').mask('000.000.000.000.000', {
      reverse: true
    });
    $('#porcentagem').mask('##00.0%', {
      reverse: true
    });
    $('#area').mask('##000m', {
      reverse: true
    });
  });
</script>
      <div class="modal fade" id="TipoModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <form class="row g-3" action="/novo_tipo" method="post">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="TipoModalLabel">Criar tipo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <div class="form-group">
            <label for="tipo">Tipo</label>
            <input type="text" id="tipo" name="tipo" class="form-control">
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="submit" class="btn btn-dark btn-salvar">Salvar</button>
      </div>
    </div>
  </div></form>
</div>
      <div class="modal fade" id="BairroModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <form class="row g-3" action="/novo_bairro" method="post">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Criar tipo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <div class="form-group">
            <label for="cidade_bairro">Cidade</label>
            <select class="form-select" id="cidade_bairro" name="cidade_bairro">
                <option value="0" selected>Selecione a tipo</option>
                    {% for cidade in cidades %}
                        <option value="{{ cidade._id_cidade }}">{{ cidade._cidade_nome}}</option>
                    {% endfor %}
            </select>
          </div>
          <div class="form-group">
            <label for="bairro">Bairro</label>
            <input type="text" id="bairro" name="bairro" class="form-control">
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="submit" class="btn btn-dark btn-salvar">Salvar</button>
      </div>
    </div>
  </div></form>
</div>
      <div class="modal fade" id="CidadeModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <form class="row g-3" action="/nova_cidade" method="post">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="CidadeModalLabel">Criar tipo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <div class="form-group">
            <label for="cidade">Cidade</label>
            <input type="text" id="cidade" name="cidade" class="form-control">
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          <button type="submit" class="btn btn-dark btn-salvar">Salvar</button>
      </div>
    </div>
  </div></form>
</div>
<h1>Cadastro de imoveis</h1>
<br>
<form class="row g-3 needs-validation" action="/atualizar_imovel" method="post" novalidate>
  <fieldset>
    <nav>
      <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-link active" id="nav-corretor-tab" data-bs-toggle="tab" href="#nav-corretor" role="tab"
          aria-controls="nav-corretor" aria-selected="true">Cadastro do Imovel</a>
        <a class="nav-link" id="nav-imovel-tab" data-bs-toggle="tab" href="#nav-imovel" role="tab"
          aria-controls="nav-imovel" aria-selected="false">Descrição Imovel</a>
        <a class="nav-link" id="nav-prop-tab" data-bs-toggle="tab" href="#nav-prop" role="tab" aria-controls="nav-prop"
          aria-selected="false">Proprietario e Corretor</a>
      </div>
    </nav>
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="nav-corretor" role="tabpanel" aria-labelledby="nav-corretor-tab">
        <input type="hidden" name="id" value="{{imovel._imob_id}}">
        <br>
        <div class="row">
          <div class="col">
            <label for="tipos">Tipos</label>
            <select class="form-select" id="tipos" name="tipos" required>
              <option value="{{ imovel._tipo._id_tipo }}" selected>{{ imovel._tipo._tipo_nome}}</option>
              {% for tipo in tipos %}
              <option value="{{ tipo._id_tipo }}">{{ tipo._tipo_nome}}</option>
              {% endfor %}
            </select>
            <div class="invalid-feedback">
              Por favor insira um tipo.
              </div>
          </div>
          <div class="col-md-1">
            <br>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#TipoModal">Criar
              tipo</button>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col">
            <label for="cidades">Cidade</label>
            <select class="form-select" id="cidades" name="cidades" required>
              <option value="{{imovel._cidade._id_cidade}}" selected>{{ imovel._cidade._cidade_nome }}</option>
              {% for cidade in cidades %}
              <option value="{{ cidade._id_cidade }}">{{ cidade._cidade_nome}}</option>
              {% endfor %}
            </select>
            <div class="invalid-feedback">
              Por favor insira uma cidade.
              </div>
          </div>
          <div class="col-md-1">
            <br>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#CidadeModal">Criar
              cidade</button>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col">
            <label for="bairros">Bairros</label>
            <select class="form-select" id="bairros" name="bairros" required>
              <option value="{{ imovel._bairro._id_bairro }}" selected>{{imovel._bairro._bairro_nome}} / {{imovel._bairro._bairro_cid_nome}}
              </option>
              {% for bairro in bairros %}
              <option value="{{ bairro._id_bairro }}">{{bairro._bairro_nome}} / {{bairro._bairro_cid_nome}} </option>
              {% endfor %}
            </select>
            <div class="invalid-feedback">
              Por favor insira um bairro.
              </div>
          </div>
          <div class="col-md-1">
            <br>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#BairroModal">Criar
              bairro</button>
          </div>
        </div>
        <br>

        <div class="form-group">
          <label for="endereco">Endereço</label>
          <input type="text" id="endereco" name="endereco" class="form-control" value="{{ imovel._endereco }}" required>
              <div class="invalid-feedback">
              Please provide a valid endereco.
              </div>
        </div>
        <br>
        <div class="form-group">
          <label for="finalidade">Finalidade</label>
          <select class="form-select" id="finalidade" name="finalidade" required>
            <option value="{{imovel._finalidade}}" selected>{{imovel._finalidade}}</option>
            <option value="Residencial">Residencial</option>
            <option value="Comercial">Comercial</option>
            <option value="Industrial">Industrial</option>
          </select>
          <div class="invalid-feedback">
              Por favor insira uma finalidade.
              </div>
        </div>
      </div>
      <div class="tab-pane fade" id="nav-imovel" role="tabpanel" aria-labelledby="nav-imovel-tab">
        <br>
        <div class="form-group">
          <label for="area">Àrea</label>
          <input type="text" id="area" name="area" class="form-control" value="{{imovel.area}}" required>
          <div class="invalid-feedback">
              Por favor insira uma area.
              </div>
        </div>
        <br>
        <div class="form-group">
          <span class="form-group-text">Detalhes do imóvel </span>
          <textarea class="form-control" aria-label="With textarea" id="detalhes" name="detalhes" ></textarea>
        </div>
        <br>
        <div class="form-group">
          <label for="banheiro">Banheiro</label>
          <input type="number" id="banheiro" name="banheiro" class="form-control" value="{{imovel._banheiro}}">
        </div>
        <br>
        <div class="form-group">
          <label for="quartos">Quartos</label>
          <input type="number" id="quartos" name="quartos" class="form-control" value="{{imovel._quartos}}">
        </div>
        <br>
        <div class="form-group">
          <label for="garagem">Garagem</label>
          <input type="number" id="garagem" name="garagem" class="form-control" value="{{imovel._garagem}}">
        </div>
        <br>
        <div class="form-group">
          <label for="valor">Valor</label>
          <input type="text" id="valor" name="valor" class="form-control" value="{{imovel.valor_imovel}}" required>
          <div class="invalid-feedback">
              Por favor insira um valor.
              </div>
        </div>
        <br>
        <div class="form-group">
          <label for="status">Status</label>
          <select class="form-select" id="status" name="status" required>
            <option value="{{imovel._status}}" selected>{{imovel._status}}</option>
            <option value="Livre">Livre</option>
            <option value="Ocupado">Ocupado</option>
            <option value="Vendido">Vendido</option>
          </select>
          <div class="invalid-feedback">
              Por favor insira o status.
              </div>
        </div>
        <br>
        <div class="form-group">
          <label for="porcentagem">Porcentagem</label>
          <input type="text" id="porcentagem" name="porcentagem" class="form-control" value="{{imovel._porcentagem}}" required>
          <div class="invalid-feedback">
              Por favor insira uma porcentagem.
              </div>
        </div>
      </div>
      <div class="tab-pane fade" id="nav-prop" role="tabpanel" aria-labelledby="nav-prop-tab">
        <br>
        <div class="mb-3">
          <select class="form-select" name="proprietario" id="proprietario" required>
            <option value="{{ imovel._proprietario._id }}" selected>{{ imovel._proprietario._nome }}</option>
            {% for proprietario in proprietarios %}
            <option value="{{ proprietario._id }}">{{ proprietario._nome }}</option>
            {% endfor %}
          </select>
          <label for="proprietario">Proprietario</label>
          <div class="invalid-feedback">
              Por favor insira um proprietario.
              </div>
        </div>
        <br>
        <div class="mb-3">
          <select class="form-select" name="corretor" id="corretor" required>
            <option value="{{ imovel._corretor._id_corr}}" selected>{{ imovel._corretor._nome}}</option>
            {% for corretor in corretores %}
            <option value="{{ corretor._id_corr }}">{{ corretor._nome }}</option>
            {% endfor %}
          </select>
          <label for="corretor">Corretor</label>
          <div class="invalid-feedback">
              Por favor insira um corretor.
              </div>
        </div>
        <script>
          $(document).ready(function () {
            $('#corretor').select2();
          });

          $(document).ready(function () {
            $('#proprietario').select2();
          });
        </script>
      </div>
    </div>
    <br>
    <button type="submit" class="btn btn-dark btn-salvar">Salvar</button>
    <a href="{{url_for('index')}}"><button type="button" class="btn btn-danger">Voltar</button></a>
  </fieldset>
</form>

<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
{% endblock %}